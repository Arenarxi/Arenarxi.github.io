window.__require=function t(e,o,n){function i(c,r){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!r&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var h=o[c]={exports:{}};e[c][0].call(h.exports,function(t){return i(e[c][1][t]||t)},h,h.exports,t,e,o,n)}return o[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({UI:[function(t,e,o){"use strict";cc._RF.push(e,"880c4wU7aVIBqtZNoknyNpf","UI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,c=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(c=(a<3?i(c):a>3?i(e,o,c):i(e,o))||c);return a>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,r=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.charts=null,e.game=null,e.nicknameLabel=null,e.scoreLabel=null,e.serverLabel=null,e.menu=null,e.hint=null,e.information=new Object,e.nameAndScoreObj=new Object,e.colorTable=new Object,e.page=new Object,e.pageNumber=0,e.infoPage=null,e}return i(e,t),e.prototype.onLoad=function(){this.information.changeFlag=!1,this.nameAndScoreObj.changeFlag=!1,this.node.zIndex=1,this.colorTable.flag=!1,this.closeInfo(),this.closeMenu(),this.nicknameLabel.active=!1,this.scoreLabel.active=!1,this.serverLabel.active=!1},e.prototype.start=function(){},e.prototype.closeMenu=function(){this.node.getChildByName("menu").active=!1,this.node.getChildByName("openMenu").active=!0},e.prototype.openMenu=function(){this.node.getChildByName("menu").active=!0,this.node.getChildByName("openMenu").active=!1},e.prototype.somethingInfo=function(t){var e=this;this.infoPage.active=!0,this.node.getChildByName("menu").active=!1,this.node.getChildByName("openMenu").active=!1;var o=this.infoPage.getChildByName("tital"),n=this.infoPage.getChildByName("info");if(o.getComponent(cc.Label).string=t.tital,"History"==t.tital&&((i=t.data).forEach(function(t){e.page[t.GID],e.page[t.GID];for(var o=0;o<(t.Players.length<20?t.Players.length:20);o++)t.Players[o].Name,t.Players[o].Score}),this.pageNumber=0,n.getComponent(cc.Label).string=this.page[this.pageNumber],0==i.length&&(n.getComponent(cc.Label).string="nope")),"Alives"==t.tital){console.log(t);var i=t.data,a="";i.forEach(function(t){t.Alive&&(a+=t.Name+"\n")}),this.pageNumber=0,n.getComponent(cc.Label).string=a,0==i.length&&(n.getComponent(cc.Label).string="nope")}},e.prototype.closeInfo=function(){this.infoPage.active=!1,this.openMenu()},e.prototype.takeHint=function(){this.hint.active=!0,this.closeMenu()},e.prototype.closeHint=function(){this.hint.active=!1,this.openMenu()},e.prototype.openHistory=function(){var t=new Object;t.tital="History",t.data="tteesstt\nfucklalal\n3row",this.somethingInfo(t),this.closeMenu(),this.node.getChildByName("openMenu").active=!1},e.prototype.refCharts=function(){Object.assign(this.charts.getComponent("charts").information,this.information)},e.prototype.update=function(){this.information.changeFlag&&(this.refCharts(),this.information.changeFlag=!1),this.colorTable.flag||(this.colorTable.table=this.game.getComponent("game").colorTable,this.colorTable.flag=!0,this.charts.getComponent("charts").colorTable=this.colorTable),this.nameAndScoreObj.changeFlag&&(this.nicknameLabel.active=!0,this.scoreLabel.active=!0,this.nicknameLabel.getComponent(cc.Label).string="Name: "+this.nameAndScoreObj.name,this.scoreLabel.getComponent(cc.Label).string="Score: "+this.nameAndScoreObj.score,this.nameAndScoreObj.changeFlag=!1)},a([s(cc.Node)],e.prototype,"charts",void 0),a([s(cc.Node)],e.prototype,"game",void 0),a([s(cc.Node)],e.prototype,"nicknameLabel",void 0),a([s(cc.Node)],e.prototype,"scoreLabel",void 0),a([s(cc.Node)],e.prototype,"serverLabel",void 0),a([s(cc.Node)],e.prototype,"menu",void 0),a([s(cc.Node)],e.prototype,"hint",void 0),a([s(Object)],e.prototype,"information",void 0),a([s(Object)],e.prototype,"nameAndScoreObj",void 0),a([s(Object)],e.prototype,"colorTable",void 0),a([s(Object)],e.prototype,"page",void 0),a([s(Number)],e.prototype,"pageNumber",void 0),a([s(cc.Node)],e.prototype,"infoPage",void 0),a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],block:[function(t,e,o){"use strict";cc._RF.push(e,"51b11pyqQFDmKr27A7pYhrS","block");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,c=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(c=(a<3?i(c):a>3?i(e,o,c):i(e,o))||c);return a>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,r=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.game=null,e.index=-5,e}return i(e,t),e.prototype.click=function(){this.game.getComponent("game").blockIndex=this.index,this.game.getComponent("game").blockClickFlag=!0},e.prototype.onLoad=function(){},e.prototype.start=function(){},a([s(cc.Node)],e.prototype,"game",void 0),a([s(Number)],e.prototype,"index",void 0),a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],charts:[function(t,e,o){"use strict";cc._RF.push(e,"20ffahEz61DCJ2+OLCEc7q0","charts");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,c=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(c=(a<3?i(c):a>3?i(e,o,c):i(e,o))||c);return a>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,r=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.information=new Object,e.chartsBar=null,e.chartsBarFlag=!1,e.colorTable=new Object,e.minifyFlag=!1,e}return i(e,t),e.prototype.onLoad=function(){this.information.Player=new Object,this.information.Player.changeFlag=!1,this.information.changeFlag=!1,this.colorTable.flag=!1},e.prototype.start=function(){},e.prototype.chartsMinyfy=function(){if(this.minifyFlag){for(t=this.node.children,e=0;e<6;e++)t[e].active=!0;this.minifyFlag=!1,this.node.width=240,this.node.height=160,this.node.y-=60,this.node.x-=60}else{for(var t=this.node.children,e=0;e<6;e++)t[e].active=!1;this.node.width=50,this.node.height=50,this.node.y+=60,this.node.x+=60,this.minifyFlag=!0}},e.prototype.refCharts=function(){console.log("rRRRR");var t=this.information.Player.data;if(this.colorTable.flag)for(var e=0;e<t.length;e++)t[e].color=this.colorTable.table[e];if(t.sort(function(t,e){return t.Score<e.Score?1:t.Score>e.Score?-1:0}),!this.chartsBarFlag){for(e=0;e<6;e++){var o=(a=cc.instantiate(this.chartsBar)).getComponent(cc.Label);0==e?(o.string="charts",a.color=cc.color(0,0,0,0),a.getChildByName("score").active=!1):(a.anchorX=0,a.x=-100,o.string="#"+e),this.node.addChild(a)}this.chartsBarFlag=!0}if(this.chartsBarFlag){var n=t.length<5?t.length+1:6,i=this.node.children;for(e=1;e<n;e++){o=(a=i[e]).getComponent(cc.Label);var a,c=a.getChildByName("score").getComponent(cc.Label);o.string="#"+e+": "+t[e-1].Name,c.string=t[e-1].Score,a.color=t[e-1].color}}},e.prototype.update=function(){this.information.changeFlag&&(this.information.Player.changeFlag&&this.colorTable.flag&&this.refCharts(),this.information.changeFlag=!1),this.minifyFlag},a([s(Object)],e.prototype,"information",void 0),a([s(cc.Prefab)],e.prototype,"chartsBar",void 0),a([s(Boolean)],e.prototype,"chartsBarFlag",void 0),a([s(Object)],e.prototype,"colorTable",void 0),a([s(Boolean)],e.prototype,"minifyFlag",void 0),a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],game:[function(t,e,o){"use strict";cc._RF.push(e,"719calnSmdNu7J98FMzgdzZ","game");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,c=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(c=(a<3?i(c):a>3?i(e,o,c):i(e,o))||c);return a>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,r=c.ccclass,s=c.property,l=new Object,h="",p="",d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.block=null,e.ws=null,e.camera=null,e.nameEditBox=null,e.IpEditBox=null,e.ERR=null,e.accLeft=!1,e.accRight=!1,e.accUp=!1,e.accDown=!1,e.backMovespeed=10,e.lastBoarddata=new Object,e.instructionQueue=new Array,e.instBusyCounter=0,e.map=!1,e.colorTable=new Object,e.gameInfotmation=new Object,e.playerImfor=new Object,e.mouseIsLeftkeyNow=!1,e.UI=null,e.canClick=!1,e.blockIndex=-1,e.blockClickFlag=!1,e}return i(e,t),e.prototype.onLoad=function(){this.ws=new WebSocket("wss://192.168.50.62:1234"),this.ws.addEventListener("message",function(t){l.reciveType=p,l.data=JSON.parse(t.data),l.changeFlag=!0}),this.ws.onopen=function(){h="onOpen"},l.changeFlag=!1,l.reciveType="",cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeydown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.schedule(this.sendInst,.025),this.schedule(this.refplayinfo,1),this.makeColorTable(),this.gameInfotmation.Player=new Object,this.gameInfotmation.History=new Object,this.ERR.zIndex=1,this.ERR.active=!1,this.node.on(cc.Node.EventType.MOUSE_DOWN,this.onMouseDown,this)},e.prototype.refplayinfo=function(){this.instructionQueue.push("getPlayer")},e.prototype.makeColorTable=function(){for(var t=0;t<64;t++){var e=cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random()),255);this.colorTable[t]=e}},e.prototype.sendInst=function(){if("standBy"==h){var t=this.instructionQueue.shift();t&&("getPlayer"==t?(p=t.slice(),this.getPlayer()):"getBoard"==t?(p=t.slice(),this.getBoard()):"getHistory"==t?(p=t.slice(),this.getHistory()):"actionJoin"==t?(p=t.slice(),this.actionJoin()):"actionClick"==t?(p=t.slice(),this.actionClick(this.blockIndex,this.mouseIsLeftkeyNow)):console.log("wrong inst :",t),h="busy",this.instBusyCounter=0)}else"busy"==h&&(this.instBusyCounter++,this.instBusyCounter>=50&&(console.log("inst timeout"),this.somethingERR("bad connect!?")))},e.prototype.onKeydown=function(t){t.keyCode==cc.macro.KEY.a&&(this.accLeft=!0,this.accRight=!1),t.keyCode==cc.macro.KEY.d&&(this.accLeft=!1,this.accRight=!0),t.keyCode==cc.macro.KEY.w&&(this.accUp=!0,this.accDown=!1),t.keyCode==cc.macro.KEY.s&&(this.accUp=!1,this.accDown=!0)},e.prototype.onKeyUp=function(t){t.keyCode==cc.macro.KEY.a&&(this.accLeft=!1),t.keyCode==cc.macro.KEY.d&&(this.accRight=!1),t.keyCode==cc.macro.KEY.w&&(this.accUp=!1),t.keyCode==cc.macro.KEY.s&&(this.accDown=!1)},e.prototype.onMouseDown=function(t){2==t._button?this.mouseIsLeftkeyNow=!0:this.mouseIsLeftkeyNow=!1},e.prototype.initMap=function(){var t=l.data.Client;if(console.log(t),t){for(var e=0;e<t.length;e++){var o=t[e],n=cc.instantiate(this.block);if(n.getComponent("block").index=e,n.getComponent("block").game=this.node,-1!=o){var i=Math.floor(o/10);n.color=this.colorTable[i];var a=o%10;a<9?n.getChildByName("imformation").getComponent(cc.Label).string=a.toString():(n.getChildByName("imformation").getComponent(cc.Label).string="?",n.getChildByName("imformation").color=cc.color(255,36,0,255)),n.getComponent(cc.Button).interactable=!1}this.node.addChild(n)}this.lastBoarddata.Client=new Object,Object.assign(this.lastBoarddata.Client,l.data.Client),this.map=!0}},e.prototype.refMap=function(){for(var t=0;t<l.data.Client.length;t++)if(l.data.Client[t]!=this.lastBoarddata[t]){var e=l.data.Client[t];if(-1!=e){var o=Math.floor(e/10),n=this.node.children[t];n.color=this.colorTable[o];var i=e%10;i<9?n.getChildByName("imformation").getComponent(cc.Label).string=i.toString():(n.getChildByName("imformation").getComponent(cc.Label).string="?",n.getChildByName("imformation").color=cc.color(255,36,0,255)),n.getComponent(cc.Button).interactable=!1}}},e.prototype.closeERR=function(){this.ERR.active=!1},e.prototype.somethingERR=function(t){this.ERR.active=!0,this.ERR.getChildByName("error").getComponent(cc.Label).string=t},e.prototype.changeServer=function(){var t="wss://"+this.IpEditBox.string;h="";var e=this.UI.getComponent("UI").serverLabel;e.getComponent(cc.Label).string="",this.ws&&this.ws.close(),this.ws=new WebSocket(t),this.ws.addEventListener("message",function(t){l.reciveType=p,l.data=JSON.parse(t.data),l.changeFlag=!0}),this.ws.onopen=function(){h="onOpen"},this.scheduleOnce(function(){""!=h?(e.active=!0,e.getComponent(cc.Label).string="server: "+this.IpEditBox.string.slice()):this.somethingERR("fail to connect server")},3)},e.prototype.changeColor=function(){this.makeColorTable()},e.prototype.joinToGame=function(){this.instructionQueue.unshift("actionJoin")},e.prototype.takeHystory=function(){this.instructionQueue.unshift("getHistory")},e.prototype.takeAlives=function(){var t=this.UI.getComponent("UI"),e=new Object;e.tital="Alives",e.data=this.gameInfotmation.Player.data.slice(),console.log(e),t.somethingInfo(e)},e.prototype.getBoard=function(){var t=new Object;t.Type="get.board",this.ws.send(JSON.stringify(t))},e.prototype.getPlayer=function(){var t=new Object;t.Type="get.players",this.ws.send(JSON.stringify(t))},e.prototype.getHistory=function(){var t=new Object;t.Type="get.history",this.ws.send(JSON.stringify(t))},e.prototype.actionJoin=function(){var t=new Object;t.Type="action.join",t.Name=this.nameEditBox.string,this.ws.send(JSON.stringify(t))},e.prototype.actionClick=function(t,e){var o=new Object;o.Type="action.click",o.Index=t,o.Flag=!!e,this.ws.send(JSON.stringify(o))},e.prototype.makeGamePlayerinformation=function(){var t=l.data;this.gameInfotmation.Player.data=t.slice(),this.gameInfotmation.Player.changeFlag=!0,this.gameInfotmation.changeFlag=!0},e.prototype.start=function(){},e.prototype.update=function(){if("onOpen"==h&&(h="standBy",this.instructionQueue.push("getPlayer"),this.instructionQueue.push("getBoard")),l.changeFlag){if("getBoard"==l.reciveType)this.map?this.refMap():(this.initMap(),console.log("initmap")),this.instructionQueue.push("getBoard");else if("getPlayer"==l.reciveType)this.makeGamePlayerinformation();else if("getHistory"==l.reciveType){var t=new Object;t.tital="History",t.data=l.data.slice(),console.log(l),this.UI.getComponent("UI").somethingInfo(t)}else"actionJoin"==l.reciveType?0!=l.data.Code?1==l.data.Code?this.somethingERR("name already used"):2==l.data.Code?this.somethingERR("current players is full"):3==l.data.Code?this.somethingERR("game players is full"):4==l.data.Code?this.somethingERR("already in the game"):this.somethingERR("yo what the fuck?"):0==l.data.Code&&(this.UI.getComponent("UI").closeMenu(),Object.assign(this.playerImfor,l.data),console.log("join to the game"),console.log("PID =",this.playerImfor.Pid),this.playerImfor.name=this.nameEditBox.string,this.playerImfor.score=0,this.playerImfor.changeFlag=!0,this.canClick=!0):"actionClick"==l.reciveType&&(console.log(l.data.Score),0!=l.data.Code?(3==l.data.Code&&this.somethingERR("U R Not In Za Game"),4==l.data.Code&&this.somethingERR("game has not started")):(console.log(l.data.Score),-1==l.data.Score?this.somethingERR("GGGGGGGGGGGGG"):(this.playerImfor.score+=l.data.Score,this.playerImfor.changeFlag=!0)));if(1==this.gameInfotmation.changeFlag){var e=this.UI.getComponent("UI").information;Object.assign(e,this.gameInfotmation),this.gameInfotmation.changeFlag=!1}if(this.playerImfor.changeFlag){var o=this.UI.getComponent("UI").nameAndScoreObj;Object.assign(o,this.playerImfor),this.playerImfor.changeFlag=!1}l.changeFlag=!1,h="standBy"}this.blockClickFlag&&(this.instructionQueue.unshift("actionClick"),this.blockClickFlag=!1),this.accUp&&this.node.y>-(this.node.height-this.camera.height)/2&&(this.node.y-=this.backMovespeed),this.accDown&&this.node.y<(this.node.height-this.camera.height)/2&&(this.node.y+=this.backMovespeed),this.accRight&&this.node.x>-(this.node.width-this.camera.width)/2&&(this.node.x-=this.backMovespeed),this.accLeft&&this.node.x<(this.node.width-this.camera.width)/2&&(this.node.x+=this.backMovespeed)},a([s(cc.Prefab)],e.prototype,"block",void 0),a([s(WebSocket)],e.prototype,"ws",void 0),a([s(cc.Node)],e.prototype,"camera",void 0),a([s(cc.EditBox)],e.prototype,"nameEditBox",void 0),a([s(cc.EditBox)],e.prototype,"IpEditBox",void 0),a([s(cc.Node)],e.prototype,"ERR",void 0),a([s(Boolean)],e.prototype,"accLeft",void 0),a([s(Boolean)],e.prototype,"accRight",void 0),a([s(Boolean)],e.prototype,"accUp",void 0),a([s(Boolean)],e.prototype,"accDown",void 0),a([s(Number)],e.prototype,"backMovespeed",void 0),a([s(Object)],e.prototype,"lastBoarddata",void 0),a([s(Array)],e.prototype,"instructionQueue",void 0),a([s(Number)],e.prototype,"instBusyCounter",void 0),a([s(Boolean)],e.prototype,"map",void 0),a([s(Object)],e.prototype,"colorTable",void 0),a([s(Object)],e.prototype,"gameInfotmation",void 0),a([s(Object)],e.prototype,"playerImfor",void 0),a([s(Boolean)],e.prototype,"mouseIsLeftkeyNow",void 0),a([s(cc.Node)],e.prototype,"UI",void 0),a([s(Boolean)],e.prototype,"canClick",void 0),a([s(Number)],e.prototype,"blockIndex",void 0),a([s(Boolean)],e.prototype,"blockClickFlag",void 0),a([r],e)}(cc.Component);o.default=d,cc._RF.pop()},{}]},{},["UI","block","charts","game"]);